/*
 * Dosya: 11_kronometre_dk_sn.c
 * Senaryo: 4 Haneli Display'de Dakika ve Saniye sayar (Örn: 12:59 -> 13:00).
 * Vizyon: "Time Base" (Zaman Tabanı) kavramı.
 */

// ============================================================================
// BÖLÜM 1: MAIN.C DOSYASININ EN BAŞI
// ============================================================================

/* USER CODE BEGIN Includes */
#include "bizimKutuphane.h"  
/* USER CODE END Includes */

/* USER CODE BEGIN PV */
// Display'deki 4 haneyi tutan dizi: [Dk Onlar][Dk Birler] : [Sn Onlar][Sn Birler]
int sayininBasamaklari[4] = {0, 0, 0, 0}; 
/* USER CODE END PV */


// ============================================================================
// BÖLÜM 2: INTERRUPT DOSYASI (stm32f4xx_it.c)
// ============================================================================

/* USER CODE BEGIN Includes */
#include "bizimKutuphane.h" // <--- BURAYA DA LAZIM! Diziye erişmek için şart.
/* USER CODE END Includes */

// Aşağıdaki fonksiyonu bulup içine ekle:
void TIM1_UP_TIM10_IRQHandler(void)
{
  HAL_TIM_IRQHandler(&htim1);
  
  /* USER CODE BEGIN TIM1_UP_TIM10_IRQn 1 */
  
  // Saniyenin birler basamağını 1 artır
  sayininBasamaklari[3]++; 

  /* USER CODE END TIM1_UP_TIM10_IRQn 1 */
}


// ============================================================================
// BÖLÜM 3: MAIN LOOP (main.c -> while(1) içi)
// ============================================================================

/* USER CODE BEGIN 3 */

// 1. ADIM: Saniye Birler Basamağı 10 oldu mu?
if(sayininBasamaklari[3] >= 10)
{
    sayininBasamaklari[3] = 0;       // Sıfırla
    sayininBasamaklari[2]++;         // Saniye Onlar'ı artır
    
    // 2. ADIM: Saniye 60 oldu mu?
    if(sayininBasamaklari[2] >= 6)
    {
        sayininBasamaklari[2] = 0;   
        sayininBasamaklari[1]++;     // Dakika Birler'i artır

        // 3. ADIM: Dakika Birler 10 oldu mu?
        if(sayininBasamaklari[1] >= 10)
        {
            sayininBasamaklari[1] = 0;
            sayininBasamaklari[0]++; // Dakika Onlar'ı artır

            // 4. ADIM: 60 Dakika doldu mu?
            if(sayininBasamaklari[0] >= 6)
            {
               sayininBasamaklari[0] = 0; // Başa sar
            }
        }
    }
}

// 5. ADIM: EKRANI SÜRME
supur(sayininBasamaklari);

/* USER CODE END 3 */
